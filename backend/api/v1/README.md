# API v1 - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ API v1

```
api/v1/
‚îú‚îÄ‚îÄ __init__.py              # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îú‚îÄ‚îÄ router.py                # –û—Å–Ω–æ–≤–Ω–æ–π —Ä–æ—É—Ç–µ—Ä API v1
‚îú‚îÄ‚îÄ dependencies.py          # –û–±—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ schemas.py              # –û–±—â–∏–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ middleware.py           # Middleware –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ validation.py           # –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
‚îú‚îÄ‚îÄ documentation.py        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
‚îú‚îÄ‚îÄ info.py                # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏
‚îú‚îÄ‚îÄ endpoints/              # –†–æ—É—Ç–µ—Ä—ã –ø–æ –¥–æ–º–µ–Ω–∞–º
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îú‚îÄ‚îÄ users.py
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ domains/               # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–æ–º–µ–Ω–∞–º (–±—É–¥—É—â–µ–µ)
    ‚îú‚îÄ‚îÄ auth/
    ‚îú‚îÄ‚îÄ users/
    ‚îî‚îÄ‚îÄ ...
```

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

### 1. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API**
- ‚úÖ –ö–∞–∂–¥–∞—è –≤–µ—Ä—Å–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø–∞–ø–∫–µ
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –ü–ª–∞–≤–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏

### 2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–æ–º–µ–Ω–∞–º**
- üîê **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: auth, users, roles
- üè¢ **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è**: departments, company_employees, team
- üîÑ **–ü—Ä–æ—Ü–µ—Å—Å—ã**: contractors, customers, repair_requests, ved_passports
- üì∞ **–ö–æ–Ω—Ç–µ–Ω—Ç**: news, events
- üí¨ **–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏**: chat, telegram

### 3. **–û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
- **dependencies.py** - –û–±—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (auth, permissions)
- **schemas.py** - –ë–∞–∑–æ–≤—ã–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
- **validation.py** - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **middleware.py** - –û–±—â–∏–µ middleware

## üîß Middleware

### LoggingMiddleware
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-Process-Time`

### SecurityHeadersMiddleware
- `X-Content-Type-Options: nosniff`
- `X-Frame-Options: DENY`
- `X-XSS-Protection: 1; mode=block`
- `Referrer-Policy: strict-origin-when-cross-origin`

### RateLimitMiddleware
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ª–∏–º–∏—Ç—ã
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ `Retry-After`

### APIVersionMiddleware
- `X-API-Version: 1.0.0`
- `X-API-Status: active`

## ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è

### EmailValidator
```python
EmailValidator.validate_or_raise("user@example.com")
```

### PhoneValidator
```python
PhoneValidator.validate_or_raise("+7 (999) 123-45-67")
```

### PasswordValidator
```python
PasswordValidator.validate_or_raise("SecurePass123!")
```

### FileValidator
```python
FileValidator.validate_file("document.pdf", 1024*1024, "document")
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã
- `/api/v1/health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
- `/api/v1/info` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏
- `/api/v1/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `/api/v1/ping` - –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `/api/v1/docs` - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `/api/v1/domains` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–º–µ–Ω–∞—Ö
- `/api/v1/status-codes` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å –∫–æ–¥–æ–≤
- `/api/v1/examples` - –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–æ—É—Ç–µ—Ä–∞
```python
from fastapi import APIRouter
from ..dependencies import get_current_active_user
from ..schemas import APIResponse

router = APIRouter()

@router.get("/", response_model=APIResponse)
async def get_items(current_user=Depends(get_current_active_user)):
    return APIResponse(
        success=True,
        message="–°–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤",
        data={"items": []}
    )
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–æ—É—Ç–µ—Ä
```python
from .endpoints import new_router

api_router.include_router(
    new_router, 
    prefix="/new-endpoint", 
    tags=["üÜï –ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª"]
)
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

- ‚úÖ **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏**: >80%
- ‚úÖ **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞**: <200ms
- ‚úÖ **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: >99.9%
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: 100% —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ v2

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ API v2:
1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É v1
2. –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
3. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
5. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
