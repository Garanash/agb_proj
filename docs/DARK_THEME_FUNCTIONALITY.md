# Функционал темной темы

## Обзор

Реализован полнофункциональный переключатель темной темы для корпоративной платформы Алмазгеобур с поддержкой светлой, темной и системной тем.

## Основные возможности

### 1. Три режима темы
- **Светлая тема** - классический светлый интерфейс
- **Темная тема** - темный интерфейс для работы в условиях низкой освещенности
- **Системная тема** - автоматическое переключение в зависимости от настроек ОС

### 2. Переключатели темы
- **Кнопка-переключатель** - быстрое переключение между темами
- **Выпадающий список** - выбор конкретной темы
- **Переключатель-свитч** - простое включение/выключение темной темы

### 3. Автоматическое сохранение
- Сохранение выбора пользователя в localStorage
- Восстановление темы при перезагрузке страницы
- Отслеживание изменений системной темы

## Технические компоненты

### Frontend
- **Контекст**: `ThemeContext.tsx` - управление состоянием темы
- **Компонент**: `ThemeToggle.tsx` - различные варианты переключателей
- **Стили**: обновленные CSS и Tailwind конфигурации
- **Интеграция**: в настройки и сайдбар

### Конфигурация
- **Tailwind**: `darkMode: 'class'` для поддержки темной темы
- **CSS переменные**: динамические цвета для тем
- **Кастомные цвета**: специальная палитра для темной темы

## Использование

### Для пользователя
1. **Быстрое переключение**: использовать переключатель в сайдбаре
2. **Детальные настройки**: перейти в Настройки → Внешний вид
3. **Выбор темы**: использовать выпадающий список или переключатели

### Для разработчика
```tsx
import { useTheme } from '@/contexts/ThemeContext'

function MyComponent() {
  const { theme, setTheme, resolvedTheme } = useTheme()
  
  return (
    <div className="bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
      {/* Контент с поддержкой тем */}
    </div>
  )
}
```

## Стилизация

### Tailwind классы
- `dark:bg-gray-800` - темный фон
- `dark:text-gray-100` - светлый текст
- `dark:border-gray-700` - темные границы
- `dark:hover:bg-gray-700` - темные hover эффекты

### CSS переменные
```css
:root {
  --foreground-rgb: 0, 0, 0;
  --background-start-rgb: 214, 219, 220;
  --background-end-rgb: 255, 255, 255;
}

.dark {
  --foreground-rgb: 248, 250, 252;
  --background-start-rgb: 15, 23, 42;
  --background-end-rgb: 30, 41, 59;
}
```

## Компоненты

### ThemeContext
- Управление состоянием темы
- Автоматическое определение системной темы
- Сохранение в localStorage
- Применение класса к documentElement

### ThemeToggle
- **variant="button"** - кнопка с иконкой
- **variant="dropdown"** - выпадающий список
- **variant="switch"** - переключатель-свитч
- **size="sm|md|lg"** - различные размеры

### ThemeIndicator
- Отображение текущей темы
- Визуальный индикатор состояния

## Интеграция

### В настройках
- Полнофункциональный раздел "Внешний вид"
- Различные варианты переключателей
- Предварительный просмотр изменений
- Дополнительные настройки интерфейса

### В сайдбаре
- Быстрый переключатель темы
- Компактный интерфейс
- Мгновенное переключение

### В основных компонентах
- Обновленные стили для поддержки тем
- Адаптивные цвета и эффекты
- Консистентный дизайн

## Особенности реализации

### Производительность
- Ленивая загрузка контекста
- Минимальные перерендеры
- Эффективное применение стилей

### Доступность
- Поддержка системных настроек
- Сохранение выбора пользователя
- Плавные переходы между темами

### Совместимость
- Работает во всех современных браузерах
- Поддержка SSR (Next.js)
- Graceful degradation

## Расширение функционала

### Возможные улучшения
1. **Кастомные темы** - создание пользовательских цветовых схем
2. **Автоматическое переключение** - по времени суток
3. **Анимации переходов** - плавные переходы между темами
4. **Синхронизация** - между устройствами пользователя
5. **Предустановки** - готовые цветовые схемы

### API расширения
- `POST /api/v1/user/theme` - сохранение темы на сервере
- `GET /api/v1/user/theme` - получение сохраненной темы
- `PUT /api/v1/user/theme` - обновление темы

## Лучшие практики

### Разработка
- Всегда добавлять темные варианты для новых компонентов
- Использовать семантические цвета
- Тестировать в обеих темах
- Следить за контрастностью

### Дизайн
- Обеспечивать достаточный контраст
- Использовать консистентную палитру
- Учитывать читаемость текста
- Адаптировать иконки и изображения

## Отладка

### Проверка темы
```javascript
// В консоли браузера
document.documentElement.classList.contains('dark')
localStorage.getItem('theme')
```

### Принудительное переключение
```javascript
// Принудительно включить темную тему
document.documentElement.classList.add('dark')
localStorage.setItem('theme', 'dark')

// Принудительно включить светлую тему
document.documentElement.classList.remove('dark')
localStorage.setItem('theme', 'light')
```

## Безопасность

### Рекомендации
- Валидация сохраненных значений темы
- Защита от XSS при работе с localStorage
- Ограничение на размер сохраненных данных
- Проверка корректности CSS классов
